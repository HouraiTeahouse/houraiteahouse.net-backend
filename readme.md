[![Discord](https://discordapp.com/api/guilds/151219753434742784/widget.png)](https://discord.gg/VuZhs9V)

# Hourai Teahouse Website Backend

This is the backend package for the Hourai Teahouse website.  Thus far it was written with a "get pieces working" mindset rather than a proper design/plan and thus it requires significant cleanup & improvement.

## Setup

0. Install python 3.5.3 or newer.
0. Optionally use virtualenv to set up a virtual enviroment for the project.
0. Use ``pip install -r requirements.txt`` to install the relevant dependencies.

### Setting up the database

To set up the database, follow standard SQLAlchemy setup procedures.  Use PYTHONPATH src/houraiteahouse:
* Setup/configure mysql (or whatever you're using instead).  You can optionally use manage.py db create_db and other options to simplify this process.
* Run "manage.py db init" to initialize the Flask migrations directory
* Run "manage.py db migrate" to generate DB config from models
* Run "manage.py db upgrade" to commit changes to the database

To run the server, you have two options:
* With PYTHONPATH src, run run.py - use this option if you are planning to modify the backend, as it will automatically pick up changes.
* Set up uWSGI using the provided config (eg, uwsgi --master --ini [path to houraiteahouse_uwsgi.ini] and ensure the ini file and nginx config point to the correct paths
* Set up uWSGI to autorun via Emperor or a similar option

Before checking in code, please ensure you have cleaned up pycache or any other autogenerated files.  Please do not check in any socket created by uWSGI.

Major TODOs:
* Heavy refactoring (remove duplicate code, DB caching, etc)
* Additional features (wiki, issue tracker, etc)
